syntax = "proto3";

option go_package = "github.com/reaovyd/orcanet-market-go/internal/gen/proto";

package market;

service Market {
  rpc JoinNetwork (stream KeepAliveRequest) returns (stream KeepAliveResponse);
  rpc UploadFile(stream UploadFileRequest) returns (UploadFileResponse);
  rpc DiscoverPeers (DiscoverPeersRequest) returns (DiscoverPeersReply);
}

message JoinNetworkReply {
  string peer_id = 1;
}

message KeepAliveRequest {}
message KeepAliveResponse {
  string peer_id = 1;
}

message UploadFileRequest {
  string peer_id = 1;
  bytes chunk = 2;
  // uploaders uploading to market are clearly seeders; this port represents that
  // seeder's server that allows downloaders to download the actual file contents from
  string producer_port = 3; 
}

message UploadFileResponse {
  string filehash = 1;
}

message DiscoverPeersRequest {
  string filehash = 1;
}

message DiscoverPeersReply {
  repeated string peers = 1;
}
